
@{
    ViewBag.Title = "SeansEkle";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@{
    ViewBag.Title = "Sorular";
}


    <div class="page-header">
        <div class="row align-items-end">
            <div class="col-md-8">
                <div class="page-header-title">
                    <i class="ik ik-book bg-blue"></i>
                    <div class="d-inline">
                        <h5>Seans Bilgileri</h5>
                        <span>Seanslar</span>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <nav class="breadcrumb-container" aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item">
                            <a href="../index.html"><i class="ik ik-book"></i></a>
                        </li>
                        <li class="breadcrumb-item">
                            <a href="#">Online Derslerim</a>
                        </li>
                        <li class="breadcrumb-item">
                            <a href="#">Seans Bilgilerim</a>
                        </li>
                        <li class="breadcrumb-item active" aria-current="page">Yeni Seans Olustuma</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>


    <div>
        @using (Html.BeginForm("SeansEkle", "OnlineDers", FormMethod.Post, htmlAttributes: new { id = "form", role = "form", @class = "form-horizontal", enctype = "multipart/form-data" }))
        {
            @Html.AntiForgeryToken()
            @Html.ValidationSummary("", htmlAttributes: new { @class = "text-danger" })

            <div class="col-md-12 card" style="height:242px;">

                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <div class="card-header" style="height:10px;">
                            <h5>Seans Bilgileri</h5>
                        </div>


                        <div class="wrapper wrapper-content animated card-body">

                            <div class="row">

                                <div class="col-md-12" style="background-color:#f3f3f4;padding:15px 20px 10px 20px;height:164px;">


                                    <div class="form-group row">
                                        <div hidden>
                                            <input class="form-control" name="OnlineIcerikId" value="" />
                                        </div>
                                        <label class="col-md-2 control-label">
                                            <span>Seans Açıklama</span>

                                        </label>
                                        <div class="col-md-4">
                                            <input class="form-control" name="SeansAciklama" id="SeansAciklama" type="text" />
                                        </div>

                                        <label class="col-md-2 control-label">
                                            <span>Başarım Ölçütü Oranı(%)</span>

                                        </label>
                                        <div class="col-md-4">
                                            <input class="form-control" name="BasarımOlcutu" id="BasarimOlcutleri" type="text" />
                                        </div>

                                    </div>



                                    <div class="form-group row">
                                        <label class="col-md-2 control-label">
                                            <span>Medya</span>

                                        </label>
                                        <div class="col-md-4">
                                            <div class="fileinput fileinput-new input-group" data-provides="fileinput">
                                                <div class="form-control" data-trigger="fileinput">
                                                    <i class="glyphicon glyphicon-file fileinput-exists"></i>
                                                    <span class="fileinput-filename"></span>
                                                </div>
                                                <span class="input-group-addon btn btn-default btn-file"><span class="fileinput-new">Select file</span><span class="fileinput-exists">Degistir</span><input type="file" name="Medya"></span>
                                                <a href="#" class="input-group-addon btn btn-default fileinput-exists" data-dismiss="fileinput">Kaldır</a>
                                            </div>
                                        </div>
                                        <label class="col-md-2 control-label">
                                            <span>Başarım Ölçütü Cevap Tipi</span>

                                        </label>


                                        <div class="col-md-4">
                                            <div class="radio radio-danger" style="margin-bottom:3px;">
                                                <input type="radio" id="Coklu" value="Coklu" name="CevapTipi" onclick="kontrol(1)">
                                                <label for="Coklu">
                                                    Coktan Secmeli
                                                </label>
                                            </div>

                                            <div class="radio radio-danger" style="margin-bottom:-10px;">

                                                <input type="radio" id="DY" value="DY" name="CevapTipi" onclick="kontrol(1)">
                                                <label for="DY">
                                                    Dogru Yanlıs
                                                </label>

                                            </div>
                                        </div>





                                        <div class="col-md-9">

                                        </div>

                                        <div class="col-md-3 card" style="margin-top:15px;margin-right:-10px;">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <a id="SoruEkle" style="position:absolute;right:17px;width:150px;" class="btn btn-outline-success">
                                                        <i class="ik ik-plus"> </i><span> Soru Ekle</span>
                                                    </a>
                                                </div>
                                                <div class="col-md-6">
                                                    <button type="submit" id="Kaydet" style="position:absolute;right:37px;width:150px;" class="btn btn-outline-success">
                                                        <i class="ik ik-save"> </i><span> Kaydet</span>
                                                    </button>
                                                </div>

                                            </div>

                                        </div>


                                    </div>
                                </div>



                            </div>

                        </div>


                    </div>

                </div>

            </div>
            
            }

    <form id="insert_form">
        <div class="col-md-12" id="Sorular">
            <div class="ibox float-e-margins">
                <div class="ibox-title">


                    <div class="wrapper wrapper-content animated ">


                        <div class="panel-group" id="accordion" style="margin-right:50px;height:297px;width:1397px; overflow-x: hidden; overflow-y: scroll;">


                        </div>


                    </div>

                </div>
            </div>
        </div>
    </form>


       
    </div>





@section Styles
{

    <link href="~/Content/plugins/sweetalert/css/sweetalert.css" rel="stylesheet" />
    <link href="~/Content/plugins/AwesomeCheckBox/css/awesomecheckbox.css" rel="stylesheet" />
    <link href="~/Content/dist/css/build.css" rel="stylesheet" />
    <link href="~/Content/plugins/jasny/jasny-bootstrap.min.css" rel="stylesheet" />
   
    <style>

        .secenekler {
            width: 50px;
            height: 22px;
        }

        .Sıklar {
            margin-top: -15px;
            margin-left: 85px;
        }

        .sıklar {
            height: 30px;
            width: 1200px;
            margin-right: 15px;
            font-weight: bold;
        }

        .spanstil {
            margin-left: 1170px;
            font-size: x-small;
            font-style: italic;
        }
    </style>

}

@section Scripts {


    <script src="~/Content/plugins/sweetalert/dist/sweetalert.min.js"></script>
    <script src="~/Content/plugins/iCheck/icheck.min.js"></script>
    <script src="~/Content/plugins/jasny/jasny-bootstrap.min.js"></script>
    <script type="text/javascript">

        var degisimsayisi = 0;
        var radiobuton = 0;
        var sorusayisi = 0;
        var soneklenen = 1;

        function kontrol(sonuc) {

            if (sonuc == 1) {
                radiobuton = document.querySelector('input[name="CevapTipi"]:checked').value;
            }

        }

        function changeState(el) {
            if (el.readOnly) el.checked = el.readOnly = false;
            else if (!el.checked) el.readOnly = el.indeterminate = true;
        }

        $(document).ready(function () {


            $('#insert_form').on('submit', function (event) {
                event.preventDefault();
                
               
                var form_data = $(this).serializeArray();

                alert(form_data[0]);

            });

       





            $('.custom-file-input').on('change', function () {
                let fileName = $(this).val().split('\\').pop();
                $(this).next('.custom-file-label').addClass("selected").html(fileName);
            });

            $("#Sorular").hide();


            //#region SoruEkle Butonu tık
            $(document).on('click', "#SoruEkle", function (e) {

              


                if (sorusayisi == 0) {
                    sorusayisi = 1;

                }

                if (radiobuton == 0) {
                    swal({
                        title: "Opss..",
                        text: "Soru Eklemek İçin Cevap Tipi Seçiniz!",
                        icon: "error",
                        button: "Kapat!",
                    });
                    sorusayisi = 0;
                }
                else {

                    $("#Sorular").show();



                    if (sorusayisi != 1) {
                        var collapse = "";
                        var arti = "ik ik-plus-circle";
                    }
                    else {
                        collapse = "in";
                        arti = "ik ik-minus-circle";
                    }

                    if (radiobuton == "Coklu") {
                        $("#accordion").prepend(`<div class="panel panel-default">
                                                                                                          <div class="panel-heading" style="background-color:#f3f3f4;height:52px;">
                                                                                                            <h4 class="panel-title">
                                                                                                              <a class="buton ${arti}" data-toggle="collapse" href="#collapse${sorusayisi}"  > </a>
                                                                                                              <a style="margin-left:20px">Soru ${sorusayisi}</a>
                                                                                                              <a style="margin-left:1270px;"   class="kapat btn btn-xs"  data-veri-varmi="0" data-grup-value="collapse${sorusayisi}">
                                                                                                                                                        <i class="ik ik-trash" style="color: #f44336"></i>
                                                                                                                                                        <span >Sil</span>
                                                                                                                                                    </a>
                                                                                                          </div>
                                                                                                          <div id="collapse${sorusayisi}" class="panel-collapse collapse ${collapse}">
                                                                                                            <div class="panel-body" style="padding:5px 5px 5px 5px;"><div class="form-group row" >
                                                                                                         <div hidden>
                                                                                                             <input name="OnlineSorularId" value="">
                                                                                                             <input name="OnlineIcerikId" value="">
                                                                                                             <input name="OnlineIcerikId" value="">
                                                                                                        </div>

                                                                                                       <label class="col-md-1 control-label">
                                                                                                            <span>Soru Metni:</span>

                                                                                                        </label>
                                                                                                        <div class="col-md-8">
                                                                                                            <textarea class="form-control" name="Sorular" id="SoruMetni" type="text" style=" font-weight: bold;"></textarea>
                                                                                                        </div>
                                                                                                        <div class="3" style="width:150px; background:#f3f3f4; border:1px; float:right;margin-right:100px;">
                                                                                                            <label for="file-upload" class="custom-file-upload" style="margin-left:30px;">
                                                                                                                Resim Ekle(istege baglı)
                                                                                                            </label>
                                                                                                            <input id="file-upload" type="file" name="soruimg" />
                                                                                                        </div>

                                                                                                    </div>
                                                                                                    <div class="form-group row">
                                                                                                        <label class="col-md-12 control-label">
                                                                                                            <span style="margin-right:1317px;">Cevap Secenekleri:</span>
                                                                                                        </label> <span class="spanstil"  >(Dogru Cevabı Soldan İsaretleyiniz.)</span>

                                                                                                        <div class="col-md-12" style="margin-top:9px">


                                                                                                            <div class="radio radio-success ">
                                                                                                                <input type="radio" id="radio-1-${sorusayisi}" class="secenekler" value="0" name="DogruSecenek${sorusayisi}" data-Soru-Sayi="${sorusayisi}">
                                                                                                                <label for="radio-1-${sorusayisi}" class="Sıklar">A:
                                                                                                                <input class="SıkInput${sorusayisi} sıklar" name="Secenek1" id="Soru${sorusayisi}Secenek0" style="background-color:white" > </label>
                                                                                                            </div> </br>


                                                                                                            <div class="radio radio-success">
                                                                                                               <input type="radio" id="radio-2-${sorusayisi}" class="secenekler" value="1" name="DogruSecenek${sorusayisi}" data-Soru-Sayi="${sorusayisi}">
                                                                                                               <label for="radio-2-${sorusayisi}" class="Sıklar">B:  <input class="SıkInput${sorusayisi} sıklar "  name="Secenek2" id="Soru${sorusayisi}Secenek1" ></label>

                                                                                                            </div> </br>


                                                                                                            <div class="radio radio-success">
                                                                                                                <input type="radio" id="radio-3-${sorusayisi}" class="secenekler" value="2" name="DogruSecenek${sorusayisi}" data-Soru-Sayi="${sorusayisi}">
                                                                                                                <label for="radio-3-${sorusayisi}" class="Sıklar">C:<input class="SıkInput${sorusayisi} sıklar"  name="Secenek3" id="Soru${sorusayisi}Secenek2" ></label>

                                                                                                            </div> </br>


                                                                                                            <div class="radio radio-success">
                                                                                                              <input type="radio" id="radio-4-${sorusayisi}" class="secenekler" value="3" name="DogruSecenek${sorusayisi}" data-Soru-Sayi="${sorusayisi}">
                                                                                                              <label for="radio-4-${sorusayisi}" class="Sıklar"> D:<input class="SıkInput${sorusayisi} sıklar"  name="Secenek4" id="Soru${sorusayisi}Secenek3"></label>
                                                                                                            </div> </br>

                                                                                                        </div>
                                                                                                    </div>

                                                                                                </div>

                                                                                            </div>
                                                                                        </div>


                                                                                                                                    </div>

                                                                                                                                    </div>
                                                                                                          </div>
                                                                                                        </div> `);


                    }

                    else {

                        $("#accordion").prepend(`<div class="panel panel-default">
                                                                                                          <div class="panel-heading" style="background-color:##f3f3f4;">
                                                                                                            <h4 class="panel-title">
                                                                                                              <a class="buton ${arti}" data-toggle="collapse" href="#collapse${sorusayisi}"  > </a>
                                                                                                              <a style="margin-left:20px">Soru ${sorusayisi}</a>
                                                                                                              <a style="margin-left:1310px"   class="kapat btn btn-xs"  data-veri-varmi="0" data-grup-value="collapse${sorusayisi}">
                                                                                                                                                        <i class="ik ik-trash" style="color: #f44336"></i>
                                                                                                                                                        <span >Sil</span>
                                                                                                                                                    </a>
                                                                                                          </div>
                                                                                                          <div id="collapse${sorusayisi}" class="panel-collapse collapse ${collapse}">
                                                                                                            <div class="panel-body"><div class="form-group row" >

                                                                                                        <div hidden>
                                                                                                             <input name="OnlineSorularId" value="">
                                                                                                             <input name="OnlineIcerikId" value="">
                                                                                                             <input name="DogruYanlisSorularId" value="">
                                                                                                        </div>


                                                                                                        <label class="col-md-1 control-label">
                                                                                                            <span>Soru Metni:</span>

                                                                                                        </label>
                                                                                                        <div class="col-md-8">
                                                                                                            <textarea class="form-control" name="Soru" id="SoruMetni" type="text" style=" font-weight: bold;"></textarea>
                                                                                                        </div>
                                                                                                        <div class="3" style="width:250px; background:#f3f3f4; border:1px; float:right;margin-right:100px;">
                                                                                                            <div class="fileinput fileinput-new" data-provides="fileinput">
                                                                            <span class="btn btn-default btn-file"><span class="fileinput-new">Select file</span><span class="fileinput-exists">Change</span><input type="file" name="..."></span>
                                                                            <span class="fileinput-filename"></span>
                                                                            <a href="#" class="close fileinput-exists" data-dismiss="fileinput" style="float: none">&times;</a>
                                                                        </div>
                                                                                                        </div>

                                                                                                    </div>
                                                                     <div class="form-group row">
                                                                                        <div class="col-md-12">
                                                                                                       <div class="col-md-1"> <label class=" control-label">
                                                                                                            <span>Cevap:</span>

                                                                                                        </label>
                                                                                                        </div>



                                                                                                      <div class="col-md-1">      <div class="radio radio-success row">
                                                                                                                 <input type="radio" class="Dy" value="0" name="DogruYanlis${sorusayisi} DogruSecenek" data-Soru-Sayi="${sorusayisi}">
                                                                                                                  <label  disabled>Dogru</label>
                                                                                                            </div> </br>
</div>

                                                                                                         <div class="col-md-1">   <div class="radio radio-success row">
                                                                                                               <input type="radio" class="Dy" value="1" name="DogruYanlis${sorusayisi} DogruSecenek" data-Soru-Sayi="${sorusayisi}">
                                                                                                               <label  disabled>Yanlis</label>
                                                                                                            </div> </br>

</div>
                                                                                                        </div>

                                                                                                    </div>


                                                                                                                                    </div>

                                                                                                                                    </div>
                                                                                                          </div>
                                                                                                        </div> `);




                    }

            
                    sorusayisi += 1;
                    soneklenen = sorusayisi;
                }
            });
            //#endregion

            //#region CevapTipine Göre Değişim
            $(document).on('change', 'input[name="CevapTipi"]', function (e) {
                
                if (degisimsayisi != 0) {
                  
                  
                    if (sorusayisi != 0) {
                        
                        swal({
                            title: "Emin misiniz?",
                            text: "Cevap tipini değistirirseniz eklediğiniz sorular kaldırılacakır!",
                            type: "warning",
                            showCancelButton: true,
                            confirmButtonColor: "#DD6B55",
                            confirmButtonText: "Evet",
                            cancelButtonText: "Hayır",
                            closeOnConfirm: false,
                            closeOnCancel: false
                            
                        }, 
                            function (isConfirm) {
                              
                                if (isConfirm) {
                                    swal("Değiştirildi!", "Sorularınız kaldırılmıştır", "success");
                                     
                                    $("#accordion").empty();
                                    sorusayisi = 0;
                                } else {
                                    swal("", "Cevap Tipi Değiştirilmedi!", "error");
                                    var degistirmebutonu = document.querySelector('input[name="CevapTipi"]:checked').value;
                                    if (degistirmebutonu == "DY") {

                                        document.getElementById("Coklu").checked = true;
                                        radiobuton = "Coklu";
                                    };

                                    if (degistirmebutonu == "Coklu") {


                                        document.getElementById("DY").checked = true;
                                        radiobuton = "DY";
                                    };


                                }
                            }
                        );

                    };

                }

                degisimsayisi = 1;

            });

            //#endregion

            //#region + - butonu
            $(document).on("click", ".buton", function () {
                if ($(this).attr('class') == "buton ik ik-plus-circle") {
                    $(this).removeClass();
                    $(this).addClass("buton ik ik-minus-circle");
                }

                else {
                    $(this).removeClass();
                    $(this).addClass("buton ik ik-plus-circle");
                }
            });
            //#endregion

            $(document).on("click", ".secenekler", function () {



                var sayi = $(this).attr('data-Soru-Sayi');

                var aaa = 'input[name="DogruSecenek' + sayi + '"]:checked';
                var classSık = ".SıkInput" + sayi;
                $(classSık).css({ background: '#ffffff' }, 1000);
                var id = document.querySelector(aaa).value;


                var SecenekId = "#Soru" + sayi + "Secenek" + id;

                $(SecenekId).css({ background: '#aaff80', }, 1000);


            });

            $(document).on("click", ".kapat", function () {
                var silinecek = this.parentElement.parentElement.parentElement;
                silinecek.remove();

                sorusayisi -= 1;

            });

        });
    </script>

}


